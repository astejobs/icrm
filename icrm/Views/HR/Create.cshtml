@using icrm.Models
@model icrm.Models.Feedback

@{
    Layout = null;
}


@{
    var data = (ApplicationUser)ViewData["user"];

    var list = new SelectList(new[]
{
    new { Value = "Open", Name = "Open" },
    new { Value = "Resolved", Name = "Resolved" },
    new { Value = "Closed", Name = "Closed" },
},
"Value", "Name", 1);
    ViewData["list"] = list;

} 
<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Required meta tags -->

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Meta -->
    <meta name="description" content="feedback managment system.">
    <meta name="author" content="feedback">
    <title>@Resources.Resource.Create_Ticket</title>
    <!-- vendor css -->
    <link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
    <link rel="stylesheet" href="http://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css" />
    <link href="~/Content/lib/jquery-toggles/css/toggles-full.css" rel="stylesheet">
    <link href="~/Content/lib/jt.timepicker/css/jquery.timepicker.css" rel="stylesheet">
    <link href="~/Content/lib/spectrum/css/spectrum.css" rel="stylesheet">
    <link href="~/Content/lib/bootstrap-tagsinput/css/bootstrap-tagsinput.css" rel="stylesheet">
    <!-- Feadback CSS -->
    <link rel="stylesheet" href="~/Content/css/slim.css">
</head>
<body>
    @Html.Partial("_HRMenu")
    <!-- slim-navbar -->
    <div class="slim-mainpanel">
        <div class="container">
            <div class="slim-pageheader">
                <ol class="breadcrumb slim-breadcrumb">
                    <li class="breadcrumb-item"><a href="#">@Resources.Resource.Home</a></li>
                    <li class="breadcrumb-item active" aria-current="page">@Resources.Resource.Create_Ticket</li>
                </ol>
                <h6 class="slim-pagetitle">@Resources.Resource.Create_Ticket</h6>
            </div>
            <!-- slim-pageheader -->
            @Html.ValidationSummary()
            @using (Html.BeginForm("Create", "HR", FormMethod.Post, new { @class = "form-horizontal", role = "form", enctype = "multipart/form-data" }))
            {

                @Html.AntiForgeryToken()
            <div class="section-wrapper">
                <label class="section-title">@Resources.Resource.Creating_Tickets_by_Icrm_Agent</label>
                <div class="form-layout">
                    @if (@TempData["MessageSuccess"] != null && @TempData["MessageSuccess"] == "Ticket has been Created Successfully")
                    {
                        <div class="alert alert-success" role="alert">
                            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                                <span aria-hidden="true">×</span>
                            </button>
                            <strong> @Resources.Resource.Ticket_has_been_created_Successfully</strong>
                        </div>
                    }

                    @if (@TempData["MessageSuccess"] != null && @TempData["MessageSuccess"] == "Ticket has been Updated Successfully")
                    {
                        <div class="alert alert-success" role="alert">
                            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                                <span aria-hidden="true">×</span>
                            </button>
                            <strong> @Resources.Resource.Ticket_has_been_Updated_Successfully</strong>
                        </div>
                    }
                    @if (@TempData["MessageSuccess"] != null && @TempData["MessageSuccess"] == "Ticket has been Forwarded Successfully")
                    {
                        <div class="alert alert-success" role="alert">
                            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                                <span aria-hidden="true">×</span>
                            </button>
                            <strong> @TempData["MessageSuccess"] </strong>
                        </div>
                    }
                    @if (@TempData["MessageSuccess"] != null && @TempData["MessageSuccess"] == "Ticket has been Closed Successfully")
                    {
                        <div class="alert alert-success" role="alert">
                            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                                <span aria-hidden="true">×</span>
                            </button>
                            <strong> @Resources.Resource.Ticket_has_been_Closed_Successfully</strong>
                        </div>
                    }
                    @if (@TempData["MessageSuccess"] != null && @TempData["MessageSuccess"] == "Ticket has been Resolved Successfully")
                    {
                        <div class="alert alert-success" role="alert">
                            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                                <span aria-hidden="true">×</span>
                            </button>
                            <strong> @Resources.Resource.Ticket_has_been_Resolved_Successfully</strong>
                        </div>
                    }
                    @if (@TempData["MessageSuccess"] != null && @TempData["MessageSuccess"] == "Ticket has been Rejected")
                    {
                        <div class="alert alert-success" role="alert">
                            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                                <span aria-hidden="true">×</span>
                            </button>
                            <strong> @Resources.Resource.Ticket_has_been_Rejected</strong>
                        </div>
                    }

                    @if (@TempData["Message"] != null && @TempData["Message"] == "Department should be empty")
                    {
                        <div class="alert alert-danger mg-b-0" role="alert">
                            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                                <span aria-hidden="true">×</span>
                            </button>
                            <strong>@Resources.Resource.Department_should_be_Empty</strong>
                        </div>
                    }

                    @if (@TempData["Message"] != null && @TempData["Message"] == "Comment Field should not be empty")
                    {
                        <div class="alert alert-danger mg-b-0" role="alert">
                            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                                <span aria-hidden="true">×</span>
                            </button>
                            <strong>@Resources.Resource.Comment_Field_Should_not_be_empty</strong>
                        </div>
                    }
                    @if (@TempData["Message"] != null && @TempData["Message"] == "Please enter fields properly")
                    {
                        <div class="alert alert-danger mg-b-0" role="alert">
                            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                                <span aria-hidden="true">×</span>
                            </button>
                            <strong>@Resources.Resource.Ticket_details_are_not_valid_Fill_details_properly</strong>
                        </div>
                    }

                    @if (@TempData["Message"] != null && @TempData["Message"] == "Comment field should be empty")
                    {
                        <div class="alert alert-danger mg-b-0" role="alert">
                            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                                <span aria-hidden="true">×</span>
                            </button>
                            <strong>@Resources.Resource.Comment_field_Should_be_empty</strong>
                        </div>
                    }

                    @if (@TempData["Message"] != null && @TempData["Message"] == "File Size Limit Exceeds")
                    {
                        <div class="alert alert-danger mg-b-0" role="alert">
                            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                                <span aria-hidden="true">×</span>
                            </button>
                            <strong>@TempData["Message"]</strong>
                        </div>
                    }

                    @if (@TempData["Message"] != null && @TempData["Message"] == "Ticket details are not valid,Fill details properly")
                    {
                        <div class="alert alert-danger mg-b-0" role="alert">
                            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                                <span aria-hidden="true">×</span>
                            </button>
                            <strong>@Resources.Resource.Ticket_details_are_not_valid_Fill_details_properly</strong>
                        </div>
                    }

                        <div class="alert alert-danger mg-b-0" role="alert" id="searchEmpLbldiv">
                            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                                <span aria-hidden="true">×</span>
                            </button>
                            <strong id="searchEmpLbl">
                            </strong>

                            <span class="tx-danger"></span>


                        </div>
                  
                    @Html.HiddenFor(model => model.submittedById, new { @class = "form-control", id = "submittedBy" })



                    <input type="hidden" id="hrdetail" value="@data.Id" />
                    @*@Html.HiddenFor(model => model.userId, new { @class = "form-control", id = "userID" })*@
                    @Html.HiddenFor(model => model.assignedBy, new { @class = "form-control" })
                    @Html.HiddenFor(model => model.assignedDate, new { @class = "form-control" })
                    @Html.HiddenFor(model => model.closedDate, new { @class = "form-control" })



                    <div class="row mg-b-25">
                        <div class="col-lg-4">
                            <div class="form-group">
                                <label class="form-control-label">@Resources.Resource.Employee_Id <span class="tx-danger">*</span></label>
                                @Html.TextBox("EmpIdValue", TempData["EmpIdValue"], new { @class = "form-control", id = "EmpIdValue", name = "EmpIdValue", required = "required" })
                                @Html.HiddenFor(m => m.userId, new { @class = "form-control", id = "userIdValue", name = "userIdValue"})
                            </div>


                        </div>

                       




                    </div>
                    @*@if (ViewBag.EmployeeList != null)
                             {
                                <div class="row mg-b-25">
                                    <div class="col-lg-4">
                                        <div class="form-group">
                                            <label class="form-control-label">@Resources.Resource.Employee_Id <span class="tx-danger">*</span></label>
                                            @Html.DropDownListFor(m => m.userId,
                new SelectList(ViewBag.EmployeeList,
                "Id", "EmployeeId"), "Select Employee", new { @class = "form-control select2", id = "empID", required = "required" })
                                        </div>
                                    </div>
                                    <!-- col-4 -->
                                    <!-- col-4 -->
                                    <!-- col-4 -->
                                </div>
                            }
                            else
                            {

                                <div class="row mg-b-25">
                                    <div class="col-lg-4">
                                        <div class="form-group">
                                            <label class="form-control-label">@Resources.Resource.Employee_Id <span class="tx-danger">*</span></label>

                                           @Html.DropDownList("parent",
        Enumerable.Empty<SelectListItem>(),"Select Employee", new { @class = "form-control select2", id = "empID", required = "required" })
                                        </div>
                                    </div>
                                    <!-- col-4 -->
                                    <!-- col-4 -->
                                    <!-- col-4 -->
                                </div>

                            }
                    *@
                    <!-- row -->
                    <!-- form-layout-footer -->

                </div>


                    <div id="OuterDiv" style="display:none;">

                        <div class="row mg-b-25">
                            <div class="col-lg-4">
                                <div class="form-group">
                                    <label class="form-control-label">@Resources.Resource.Name <span class="tx-danger">*</span></label>
                                    @Html.TextBox("EmpName", "", new { @readonly = "readonly", @class = "form-control", id = "EmpName" })
                                </div>
                            </div>
                            <!-- col-4 -->
                            <div class="col-lg-4">
                                <div class="form-group">
                                    <label class="form-control-label">@Resources.Resource.Badge_No <span class="tx-danger">*</span></label>
                                    @Html.TextBox("EmpBatchNo", "", new { @readonly = "readonly", @class = "form-control", id = "EmpBatch" })
                                </div>
                            </div>
                            <!-- col-4 -->
                            <div class="col-lg-4">
                                <div class="form-group">
                                    <label class="form-control-label">@Resources.Resource.Email_Id <span class="tx-danger">*</span></label>
                                    @Html.TextBox("EmpEmail", "", new { @readonly = "readonly", @class = "form-control", id = "EmpEmail" })
                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="form-group">
                                    <label class="form-control-label">@Resources.Resource.Phone_No <span class="tx-danger">*</span></label>
                                    @Html.TextBox("EmpPNo", "", new { @readonly = "readonly", @class = "form-control", id = "EmpPNo" })
                                </div>
                            </div>
                            <!-- col-4 -->
                            <div class="col-lg-4">
                                <div class="form-group">
                                    <label class="form-control-label">@Resources.Resource.Location:<span class="tx-danger">*</span></label>
                                    @Html.TextBox("EmpLocation", "", new { @readonly = "readonly", @class = "form-control", id = "EmpLocation" })
                                    @Html.Hidden("costcentrId", "", new { @readonly = "readonly", @class = "form-control", id = "costcentrId" })

                                </div>
                            </div>
                            <!-- col-4 -->
                            <!--  <div class="col-lg-4">
                  <div class="form-group">
                      <label class="form-control-label">Sub Location: <span class="tx-danger">*</span></label>
                      @**   @Html.TextBox("EmpSubLocation", "", new { @readonly = "readonly", @class = "form-control", id = "EmpSubLocation" })
                      **@
                  </div>
              </div>-->
                            <!-- col-4 -->
                            <!-- col-4 -->
                            <div class="col-lg-4">
                                <div class="form-group">
                                    <label class="form-control-label">@Resources.Resource.Job_Title: <span class="tx-danger">*</span></label>
                                    @Html.TextBox("EmpPosition", "", new { @readonly = "readonly", @class = "form-control", id = "EmpPosition" })

                                </div>
                            </div>
                            <!-- col-4 -->
                            <div class="col-lg-4">
                                <div class="form-group">
                                    <label class="form-control-label">@Resources.Resource.Nationality: <span class="tx-danger">*</span></label>
                                    @Html.TextBox("EmpNationality", "", new { @readonly = "readonly", @class = "form-control", id = "EmpNationality" })

                                </div>
                            </div>
                            <!-- col-4 -->
                            <!-- col-4 -->
                        </div>

                    </div>



                    <label class="section-title">@Resources.Resource.Feedback_Complaint</label>


                    <div class="form-layout">
                        <div class="row mg-b-25">

                            <div class="col-lg-4">
                                <div class="form-group">
                                    <label class="form-control-label">@Resources.Resource.Source <span class="tx-danger">*</span></label>
                                    @Html.DropDownListFor(model => model.mediumId,
      new SelectList(ViewBag.sourceList, "Id", "name"), "Choose", new { @class = "form-control select2",required="required" })


                                </div>
                            </div>

                            <div class="col-lg-4">
                                <div class="form-group">
                                    <label class="form-control-label">@Resources.Resource.Type <span class="tx-danger">*</span></label>
                                    @Html.DropDownListFor(model => model.typeId,
      new SelectList(ViewBag.typeList, "Id", "name"), "Choose", new { @class = "form-control select2", id="typeofFeedback",required="required" })


                                </div>
                            </div>
                            <div class="col-lg-4">
                                <div class="form-group">
                                    <label class="form-control-label">@Resources.Resource.Title<span class="tx-danger">*</span></label>
                                    @Html.TextBoxFor(model => model.title, new { @class = "form-control", required = "required" })
                                </div>
                            </div>
                            <!-- col-4 -->
                            <div class="col-lg-4">
                                <div class="form-group mg-b-10-force">
                                    <label class="form-control-label">@Resources.Resource.Description <span class="tx-danger">*</span></label>
                                    @Html.TextAreaFor(model => model.description, new { @class = "form-control", required = "required" })
                                </div>
                            </div>
                            <!-- col-4 -->
                            <div class="col-lg-4">
                                <div class="form-group">
                                    <label class="form-control-label">@Resources.Resource.Department: <span class="tx-danger">*</span></label>
                                    @Html.DropDownListFor(m => m.departmentID,
                          new SelectList(ViewBag.Departmn,
                        "Id", "name"), "Choose Department", new { @class = "form-control select2",id="deptId" })
                                </div>
                            </div>
                            <!-- col-4 -->
                            <div class="col-lg-4">
                                <div class="form-group">
                                    <label class="form-control-label">@Resources.Resource.Category: <span class="tx-danger">*</span></label>
                                    <select id="category" class="form-control select2" name="categoryId">
                                        <option value="">Choose Category</option>

                                    </select>
                                    @** @Html.DropDownListFor(m => m.categoryId,
                          new SelectList(ViewBag.Categories,
                        "Id", "name"), "Choose Category", new { @class = "form-control select2",id="category" })*@
                                </div>
                            </div>




                            <div class="col-lg-4">
                                <div class="form-group">
                                    <label class="form-control-label">@Resources.Resource.Sub_Category <span class="tx-danger">*</span></label>
                                    <select id="subcategory" class="form-control select2" name="subcategoryId">
                                        <option value="">Choose Sub Category</option>

                                    </select>

                                </div>
                            </div>

                            <div class="col-lg-4" id="priordiv" style="display:none;">
                                <div class="form-group">
                                    <label class="form-control-label">@Resources.Resource.Priority <span class="tx-danger">*</span></label>
                                    @Html.DropDownListFor(m => m.priorityId,
                           new SelectList(ViewBag.Priorities,
                         "Id", "name"), "Choose Priority", new { @class = "form-control select2",id="priorty"})
                                </div>
                            </div>


                            <!-- col-4 -->
                            <div class="col-lg-4">
                                <div class="form-group">
                                    <label class="form-control-label">@Resources.Resource.Email_Id <span class="tx-danger">*</span></label>
                                    @Html.DropDownList("emailsss",
                          new SelectList(ViewBag.Emails,
                        "", ""), new { @class = "form-control select2", Multiple = "multiple",name="emailsss" })
                                </div>
                            </div>
                            <!-- col-4 -->
                        </div>
                        <!-- row -->
                        <!-- form-layout-footer -->
                    </div>



                    <label class="section-title">@Resources.Resource.Attachment</label>


                    <div class="form-layout">
                        <div class="row mg-b-25">
                            <div class="col-lg-4">
                                <div class="form-group">
                                    <label class="form-control-label"></label>

                                    <input type="file" name="file">
                                    @Html.ValidationMessageFor(model => model.attachment, "", new { @class = "text-danger" })
                                </div>
                            </div>
                            <!-- col-4 -->


                        </div>

                        <div class="row mg-b-25">
                            <div class="col-lg-4">
                                <div class="form-group">
                                    <label class="form-control-label">@Resources.Resource.Choose_Action</label>
                                    @Html.DropDownListFor(m => m.status, new SelectList(ViewBag.Status), new { @class = "form-control", id = "statusfield" })
                                    <label class="text-danger" id="statuscheck"></label>
                                </div>
                            </div>
                            <!-- col-4 -->
                            <div class="col-lg-4">
                                <div class="form-group">
                                    <label class="form-control-label">@Resources.Resource.Comments</label>
                                    @Html.TextArea("responsee", new { @class = "form-control", name = "responsee" })


                                </div>
                            </div>
                        </div>


                        <!-- row -->
                        <div class="form-layout-footer">
                            <button class="btn btn-primary bd-0" name="submitButton" id="forward" value="Forward/Create">@Resources.Resource.Forward_Create</button>
                            <button class="btn btn-primary bd-0" value="Submit" id="resolve" name="submitButton">@Resources.Resource.Submit </button>

                        </div>
                        <!-- form-layout-footer -->
                    </div>

                </div>
            }
            <!-- container -->
        </div>
        </div>
        <!-- slim-mainpanel -->
        <div class="slim-footer">
            <div class="container">
                <p>Copyright 2018 &copy; All Rights Reserved. </p>
            </div>
            <!-- container -->
        </div>
        <!-- slim-footer -->
        <script src="~/Content/lib/jquery/js/jquery.js"></script>
        <script src="~/Content/lib/popper.js/js/popper.js"></script>
        <script src="~/Content/lib/bootstrap/js/bootstrap.js"></script>
        <script src="~/Content/lib/jquery.cookie/js/jquery.cookie.js"></script>
        <script src="~/Content/lib/moment/js/moment.js"></script>
        <script src="~/Content/lib/jquery-ui/js/jquery-ui.js"></script>
        <script src="~/Content/lib/jquery-toggles/js/toggles.min.js"></script>
        <script src="~/Content/lib/jt.timepicker/js/jquery.timepicker.js"></script>
        <script src="~/Content/lib/spectrum/js/spectrum.js"></script>
        <script src="~/Content/lib/jquery.maskedinput/js/jquery.maskedinput.js"></script>
        <script src="~/Content/lib/bootstrap-tagsinput/js/bootstrap-tagsinput.js"></script>
        <script src="~/Content/js/slim.js"></script>
        <script>
            $('#searchEmpLbldiv').hide();
            if ($('#EmpIdValue').val() != "") {
                id = $('#EmpIdValue').val();
              
                    $.ajax({
                        type: "POST",
                        contentType: "application/json; charset=utf-8",
                        data: '{"id":"' + id + '"}',
                        url: "@Url.Action("getEmpDetails", "HR")",
                        dataType: "json",
                        success: function (response) {
                            $('#searchEmpLbldiv').hide();
                            $('#OuterDiv').show();
                            $('#userIdValue').val(response.Id);
                            $('#EmpPosition').val(response.JobTitle.name);
                            $('#EmpNationality').val(response.Nationality.name);
                            $('#EmpName').val(response.FirstName + "  " + response.LastName);
                            $('#EmpBatch').val(response.EmployeeId);
                            $('#EmpEmail').val(response.Email);
                            $('#EmpPNo').val(response.bussinessPhoneNumber);
                            $('#EmpLocation').val(response.CostCenter.costCenterDisplay);
                            $('#costcentrId').val(response.CostCenter.Id);
                            

                        },
                        error: function (response) {
                            $('#searchEmpLbldiv').show();
                            
                            $('#searchEmpLbl').text("Employee not found,Enter valid Employee Id");
                            $('#OuterDiv').hide();
                            $('#userIdValue').val(null);
                            $('#EmpIdValue').val("");
                            //alert(response.responseText)
                        }

                    })


            }
            
            if ($("#typeofFeedback").find(":selected").text() == "Complaint") {
                $('#priordiv').show();
                $("#priorty").prop('required', true);
            }
            $("#typeofFeedback").prop('required', true);
           // $('#priordiv').hide();
            $('#typeofFeedback').change(function () {
               
                if ($(this).find(":selected").text() == "Complaint") {
                    $('#priordiv').show();
                    $("#priorty").prop('required', true);
                } else {
                    $('#priordiv').hide();
                    $("#priorty").prop('required', false);
                }
            });

            (function () {


                     $(document).on('blur','#EmpIdValue',function () {
               
                var id = $('#EmpIdValue').val();

               
                if (id == "") {
                    $('#OuterDiv').hide();

                    return false;
                } else {
                    
                    $.ajax({
                        type: "POST",
                        contentType: "application/json; charset=utf-8",
                        data: '{"id":"' + id + '"}',
                        url: "@Url.Action("getEmpDetails", "HR")",
                        dataType: "json",
                        success: function (response) {
                            console.log('---in success----')
                            
                            $('#searchEmpLbl').empty();
                            $('#searchEmpLbldiv').hide();
                           
                            $('#OuterDiv').show();
                            $('#userIdValue').val(response.Id);
                            $('#EmpPosition').val(response.JobTitle.name);
                            $('#EmpNationality').val(response.Nationality.name);
                            $('#EmpName').val(response.FirstName + "  "+ response.LastName);
                            $('#EmpBatch').val(response.EmployeeId);
                            $('#EmpEmail').val(response.Email);
                            $('#EmpPNo').val(response.bussinessPhoneNumber);
                            $('#EmpLocation').val(response.CostCenter.costCenterDisplay);
                            $('#costcentrId').val(response.CostCenter.Id);
                            

                        },
                        error: function (response) {
                            console.log('---in error----')

                            $('#searchEmpLbl').empty();
                            console.log($('#searchEmpLbldiv').show());
                            $('#searchEmpLbl').text("Employee not found, Enter valid Employee Id");
                            $('#OuterDiv').hide();
                            $('#userIdValue').val(null);
                            $('#EmpIdValue').val("");

                           // alert(response.responseText)
                        }

                    })
                }

            });


            })();
           
       


            $('#forward').click(function () {
                $('#statuscheck').text("");
                $("#deptId").prop('required', true); 
                $("#emailsss").prop('required', true); 
                $("#category").prop('required', true);
                $("#subcategory").prop('required', true);
                if ($('#statusfield').val() == "Open") {
                    return true;
                } else {
                    $('#statuscheck').text("Set status Open");
                    return false;
                }               
                
                

            });

            $('#resolve').click(function () {
                $('#statuscheck').text("");
               
                if ($('#statusfield').val() == "Resolved" || $('#statusfield').val() == "Closed") {
                    $("#emailsss").prop('required', false);
                    $("#deptId").prop('required', false); 
                    $("#category").prop('required', false);
                    $("#subcategory").prop('required', false);
                    return true;
                }

                else {
                    $('#statuscheck').text("Set status Resolved/Closed");
                    $("#emailsss").prop('required', false);
                    $("#deptId").prop('required', false); 
                    $("#category").prop('required', false);
                    $("#subcategory").prop('required', false);
                    return false;

                }

            });

            var employeid = $('#empID').val();
            if (employeid == "") {
                var hrdetail = $('#hrdetail').val();
                $('#submittedBy').val(hrdetail);
            }
            $('#empID').change(function () {
                if (this.value == "") {

                    var hrdetail = $('#hrdetail').val();
                    $('#submittedBy').val(hrdetail);
                }
                else {
                    var hrdetail = $('#hrdetail').val();
                    $('#submittedBy').val(hrdetail);
                    $('#userID').val(this.value);
                }
            });

            $(function () {
                'use strict'

                // Toggles
                $('.toggle').toggles({
                    on: true,
                    height: 26
                });

                // Input Masks
                $('#dateMask').mask('99/99/9999');
                $('#phoneMask').mask('(999) 999-9999');
                $('#ssnMask').mask('999-99-9999');

                // Time Picker
                $('#tpBasic').timepicker();
                $('#tp2').timepicker({
                    'scrollDefault': 'now'
                });
                $('#tp3').timepicker();

                $('#setTimeButton').on('click', function () {
                    $('#tp3').timepicker('setTime', new Date());
                });

                // Color picker
                $('#colorpicker').spectrum({
                    color: '#17A2B8'
                });

                $('#showAlpha').spectrum({
                    color: 'rgba(23,162,184,0.5)',
                    showAlpha: true
                });

                $('#showPaletteOnly').spectrum({
                    showPaletteOnly: true,
                    showPalette: true,
                    color: '#DC3545',
                    palette: [
                        ['#1D2939', '#fff', '#0866C6', '#23BF08', '#F49917'],
                        ['#DC3545', '#17A2B8', '#6610F2', '#fa1e81', '#72e7a6']
                    ]
                });

            });

            $(function () {
                'use strict'

                // Datepicker
                $('.fc-datepicker').datepicker({
                    showOtherMonths: true,
                    selectOtherMonths: true,
                    dateFormat: 'dd-mm-yy'
                });

                $('#datepickerNoOfMonths').datepicker({
                    showOtherMonths: true,
                    selectOtherMonths: true,
                    numberOfMonths: 2
                });

            });



            $("#deptId").change(function () {

                
                    $("#category option").remove();

                    $('#category').append('<option value="">' + "Choose Category" + '</option>');

                    $("#subcategory option").remove();
                
                $('#subcategory').append('<option value="">' + "Choose Sub Category" + '</option>');
                if ($("#deptId").val() != "" && $("#typeofFeedback").val() != "" ) {
                    $.ajax({
                        type: "POST",
                        url: "@Url.Action("getCategories", "HR")",
                        contentType: "application/json; charset=utf-8",
                        data: '{"depId":"' + $(this).val() + '","type":"' + $('#typeofFeedback').val() + '"}',
                        dataType: "json",
                        success: function (r) {

                            for (var i = 0; i < r.length; i++) {
                                $('#category').append('<option value="' + r[i].Id + '">' + r[i].name + '</option>');

                            }
                        },
                        error: function (r) {
                            alert("error" + r.responseText);
                        }
                    });
                }
                
            });



            $("#category").change(function () {

             

                $("#subcategory option").remove();

                $('#subcategory').append('<option value="">' + "Choose Sub Category" + '</option>');
                if( $("#typeofFeedback").val() != "" && $('#category').val()!="")
            {
                $.ajax({
                    type: "POST",
                    url: "@Url.Action("getSubCategories", "HR")",
                    contentType: "application/json; charset=utf-8",
                    data: '{"categoryId":"' + $(this).val() + '","type":"' + $('#typeofFeedback').val() + '"}',
                    dataType: "json",
                    success: function (r) {

                        for (var i = 0; i < r.length; i++) {
                            $('#subcategory').append('<option value="' + r[i].Id + '">' + r[i].name + '</option>');

                        }
                    },
                    error: function (r) {
                        alert("error" + r.responseText);
                    }
                });
            }
            });
            

            $("#typeofFeedback").change(function () {
             
                $("#deptId").val("");
               // window.location.reload(true);
                $("#category option").remove();

                $('#category').append('<option value="">' + "Choose Category" + '</option>');

                $("#subcategory option").remove();

                $('#subcategory').append('<option value="">' + "Choose Sub Category" + '</option>');
                
            });

        </script>
@Html.Partial("_HRFooter")
</body>
</html>
